<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MyBatisDefault">
<!-- 自动组装Where条件  chris 2011-08-15  -->
	<sql id="Where_Clause">
		<!--
			WARNING - This element is automatically generated by Apache iBATIS
			ibator, do not modify. This element was generated on Mon Mar 15
			11:03:37 CST 2010.
		-->
		<where>
			<foreach collection="filterCriterions" item="criteria" index="index" open="where" separator="and">
				(
				<choose>
					<when test='criteria.type == "Single"'>
					${criteria.propertyName} ${criteria.opName}
					</when>
					<when test='criteria.type == "Simple"'>
						<choose>
							<when test='criteria.opName == " like "'>
								${criteria.propertyName} ${criteria.opName} '%' || #{criteria.value} || '%'
							</when>
							<otherwise>
								${criteria.propertyName} ${criteria.opName} #{criteria.value}
							</otherwise>
						</choose>
					</when>
					<when test='criteria.type == "MultiValued"'>
						${criteria.propertyName} ${criteria.opName}
						<choose>
							<when test='criteria.opName == " between "'>
								<foreach collection="criteria.paramValues" item="listValue" close=")" separator="and" open="(">
									#{listValue}
								</foreach>
							</when>
							<otherwise>
								<foreach collection="criteria.paramValues" item="listValue" close=")" separator="," open="(">
									#{listValue}
								</foreach>
							</otherwise>
						</choose>
					</when>
					<when test='criteria.type == "SQL"'>
					${criteria.propertyName}
					</when>
					<when test='criteria.type == "Junction"'>
						(
						<choose>
							<when test='criteria.opName == " or "'>
								<foreach collection="criteria.conditions" item="orCriteria" close=")" separator="or" open="(">
									(
									<choose>
										<when test='orCriteria.type == "Single"'>
										${orCriteria.propertyName} ${orCriteria.opName}
										</when>
										<when test='orCriteria.type == "Simple"'>
											<choose>
												<when test='orCriteria.opName == " like "'>
													${orCriteria.propertyName} ${orCriteria.opName} '%' || #{orCriteria.value} || '%'
												</when>
												<otherwise>
													${orCriteria.propertyName} ${orCriteria.opName} #{orCriteria.value}
												</otherwise>
											</choose>
										</when>
										<when test='orCriteria.type == "MultiValued"'>
											${orCriteria.propertyName} ${orCriteria.opName}
											<choose>
												<when test='orCriteria.opName == " between "'>
													<foreach collection="orCriteria.paramValues" item="listValue" close=")" separator="and" open="(">
														#{listValue}
													</foreach>
												</when>
												<otherwise>
													<foreach collection="orCriteria.paramValues" item="listValue" close=")" separator="," open="(">
														#{listValue}
													</foreach>
												</otherwise>
											</choose>
										</when>
										<when test='orCriteria.type == "SQL"'>
										${orCriteria.propertyName}
										</when>
									</choose>
									)
								</foreach>
							</when>
							<otherwise>
								<foreach collection="criteria.conditions" item="andCriteria" close=")" separator="and" open="(">
									(
									<choose>
										<when test='andCriteria.type == "Single"'>
										${andCriteria.propertyName} ${andCriteria.opName}
										</when>
										<when test='andCriteria.type == "Simple"'>
											<choose>
												<when test='andCriteria.opName == " like "'>
													${andCriteria.propertyName} ${andCriteria.opName} '%' || #{andCriteria.value} || '%'
												</when>
												<otherwise>
													${andCriteria.propertyName} ${andCriteria.opName} #{andCriteria.value}
												</otherwise>
											</choose>
										</when>
										<when test='andCriteria.type == "MultiValued"'>
											${andCriteria.propertyName} ${andCriteria.opName}
											<choose>
												<when test='andCriteria.opName == " between "'>
													<foreach collection="andCriteria.paramValues" item="listValue" close=")" separator="and" open="(">
														#{listValue}
													</foreach>
												</when>
												<otherwise>
													<foreach collection="andCriteria.paramValues" item="listValue" close=")" separator="," open="(">
														#{listValue}
													</foreach>
												</otherwise>
											</choose>
										</when>
										<when test='andCriteria.type == "SQL"'>
										${andCriteria.propertyName}
										</when>
									</choose>
									)
								</foreach>
							</otherwise>
						</choose>
						)
					</when>
					
				</choose>
				)
			</foreach>
		</where>
		
	</sql>

	<sql id="DynaInsertCriteria">
		<!--
			WARNING - This element is automatically generated by Apache iBATIS
			ibator, do not modify. This element was generated on Mon Mar 15
			11:03:37 CST 2010.
		-->
		<if test="dynaSQLCriteria.insert.valid">
			INSERT INTO $dynaSQLCriteria.insert.criteria.tableName$ 
			(
			<foreach collection="dynaSQLCriteria.insert.criteria.fieldNames" item="fieldName" separator=",">
				${fieldName}
			</foreach>
			) values (
			<foreach collection="dynaSQLCriteria.insert.criteria.fieldValues" item="fieldValue" separator=",">
				#{fieldValue}
			</foreach>
			)
		</if>
	</sql>
	
	<sql id="DynaUpdateCriteria">
		<!--
			WARNING - This element is automatically generated by Apache iBATIS
			ibator, do not modify. This element was generated on Mon Mar 15
			11:03:37 CST 2010.
		-->
		<if test="dynaSQLCriteria.update.valid">
			UPDATE $dynaSQLCriteria.update.criteria.tableName$ SET 
			<foreach collection="dynaSQLCriteria.update.criteria.fields" item="fieldItem" separator=",">
				${fieldItem.key} = #{fieldItem.value}
			</foreach>
		</if>
	</sql>
	
	<sql id="DynaDeleteCriteria">
		<!--
			WARNING - This element is automatically generated by Apache iBATIS
			ibator, do not modify. This element was generated on Mon Mar 15
			11:03:37 CST 2010.
		-->
		<if test="dynaSQLCriteria.delete.valid">
			DELETE FROM ${dynaSQLCriteria.delete.criteria.tableName}
		</if>
	</sql>
	
	<sql id="DynaSearchCriteria">
		<!--
			WARNING - This element is automatically generated by Apache iBATIS
			ibator, do not modify. This element was generated on Mon Mar 15
			11:03:37 CST 2010.
		-->
		<if test="dynaSQLCriteria.select.valid">
			${dynaSQLCriteria.select.criteria.sql}
		</if>
	</sql>
	
<!-- 取序列号-Oracle  chris 2011-08-22  -->
	<select id="OraclegetRecordId" resultType="java.lang.String">
		select seq_pub_idgrantor.nextval from dual
	</select>
<!-- 根据名称取序列号-Oracle  chris 2011-08-22  -->
	<select id="OracleSequence" resultType="java.lang.String">
		select $name$.nextval from dual
	</select>

<!-- 取序列号-SQL Server  chris 2011-08-22  -->
	<select id="SQLServergetRecordId" resultType="java.lang.String">
		SELECT SCOPE_IDENTITY() AS ID 
	</select>

</mapper>